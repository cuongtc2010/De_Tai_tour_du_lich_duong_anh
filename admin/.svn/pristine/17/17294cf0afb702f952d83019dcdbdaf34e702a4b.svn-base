<?phpclass Nha_tuyen_dungController {    const FOLDER_VIEW = 'Nha_tuyen_dung';    public function index() {        if (isset($_SESSION["user_info_admin"])) {            $tabid = '';            if (isset($_GET["tabid"])) {                $tabid = $_GET["tabid"];            } global $Ids;            $obj_check_role = UtilityController::checkRole();            $_IsView = $obj_check_role["view"];            $_IsUpdate = $obj_check_role["update"];            $_IsDelete = $obj_check_role["delete"];            if (!$_IsView) {                UtilityController::gotoPage("index.php");            }            // Get số trang            $page = isset($_POST["page"]) ? ((intval($_POST["page"]) < 0) ? 0 : intval($_POST["page"])) : 1;            $start = ($page - 1) * SOTRANG;            $num_rows_per_page = SOTRANG;            $Dm_nha_tuyen_dung_model = new Nha_tuyen_dungModel();            $Dm_nha_tuyen_dung_model->setRoleId($_SESSION["user_info_admin"]["role"]);            $Dm_nha_tuyen_dung_model->getUserrole($_SESSION["user_info_admin"]["username"]);            $Dm_nganh_ngheModel = new Dm_nganh_ngheModel();            $List_nganh_nghe = $Dm_nganh_ngheModel->getList();            $Dm_tinh_thanhModel = new Dm_tinh_thanhModel();            $List_tinh_thanh = $Dm_tinh_thanhModel->getList();            //  $Dm_Quy_Mo = new Dm_quy_mo_doanh_nghiepModel;            //$List_Quy_Mo = $Dm_Quy_Mo->getList();            // lấy giá trị search            $_Name = isset($_POST["nhatuyendung"]) ? $_POST["nhatuyendung"] : "";            $_TinhThanhs = isset($_POST["dm_tinh_thanh"]) ? $_POST["dm_tinh_thanh"] : "";            $_NganhNghes = isset($_POST["dm_nganh_nghe"]) ? $_POST["dm_nganh_nghe"] : "";            $_NoiBat = isset($_POST["dm_noi_bat"]) ? $_POST["dm_noi_bat"] : "5";            $_XacThuc = isset($_POST["dm_xac_thuc"]) ? $_POST["dm_xac_thuc"] : "5";            $_Active = isset($_POST["dm_active"]) ? $_POST["dm_active"] : "5";            $arr = array("number" => 1, "text" => "có");            $ar = array("number" => 0, "text" => "không");            $a = array($ar, $arr);            if (isset($_POST["gui"])) {                if (isset($_POST["checklist"])) {                    $array_ck = $_POST["checklist"];                    if ($array_ck != null) {                        $array_update = array();                        $item = "";                        foreach ($array_ck as $value) {                            $item .= $value . ",";                        }                        $item = rtrim($item, ",");                        $Dm_nha_tuyen_dung_model->setId($item);                        $sentmail_Model = new Send_mailModel();                        $Email = $Dm_nha_tuyen_dung_model->UserEmail();                        foreach ($Email as $Emails) {                            $array[] = $Emails["Username"];                        }                        $_NoiDung = $_POST["txtGuiMail"];                        //$sentmail_Model->setName('hghghghghg');                        $sentmail_Model->setBody($_NoiDung);                        $sentmail_Model->setSubject('BẠN CÓ TIN NHẮN MỚI TỪ VIECNET.COM');                        if ($array != null) {                            if ($sentmail_Model->doSend($array)) {                                UtilityController::messageSuccess();                            } else {                                UtilityController::messageError();                            }                            UtilityController::gotoPage("index.php?ctl=Nha_tuyen_dung&tabid=" . $tabid);                        }                    }                }            }            // get lists                        if (isset($_POST["xacthuc"])) {                $array = $_POST["checklist"];                if ($array != null) {                    $update_array = array();                    foreach ($array as $value) {                        $update_array[] = $value;                    }                    if ($Dm_nha_tuyen_dung_model->update_array_xacthuc($update_array)) {                        UtilityController::messageSuccess();                    } else {                        UtilityController::messageError();                    }                } else {                    UtilityController::message('Bạn chưa chọn nhà tuyển dụng');                }            }            if (isset($_POST["khongxacthuc"])) {                $array = $_POST["checklist"];                if ($array != null) {                    $update_array = array();                    foreach ($array as $value) {                        $update_array[] = $value;                    }                    if ($Dm_nha_tuyen_dung_model->update_array_khongxacthuc($update_array)) {                        UtilityController::messageSuccess();                    } else {                        UtilityController::messageError();                    }                } else {                    UtilityController::message('Bạn chưa chọn nhà tuyển dụng');                }            }            if (isset($_POST["noibat"])) {                $array = $_POST["checklist"];                if ($array != null) {                    $update_array = array();                    foreach ($array as $value) {                        $update_array[] = $value;                    }                    if ($Dm_nha_tuyen_dung_model->update_array_noibat($update_array)) {                        UtilityController::messageSuccess();                    } else {                        UtilityController::messageError();                    }                } else {                    UtilityController::message('Bạn chưa chọn nhà tuyển dụng');                }            }            if (isset($_POST["khongnoibat"])) {                $array = $_POST["checklist"];                if ($array != null) {                    $update_array = array();                    foreach ($array as $value) {                        $update_array[] = $value;                    }                    if ($Dm_nha_tuyen_dung_model->update_khongnoibat($update_array)) {                        UtilityController::messageSuccess();                    } else {                        UtilityController::messageError();                    }                } else {                    UtilityController::message('Bạn chưa chọn nhà tuyển dụng');                }            }            if (isset($_POST["hoatdong"])) {                $array = $_POST["checklist"];                if ($array != null) {                    $update_array = array();                    foreach ($array as $value) {                        $update_array[] = $value;                    }                    if ($Dm_nha_tuyen_dung_model->update_array_hoatdong($update_array)) {                        UtilityController::messageSuccess();                    } else {                        UtilityController::messageError();                    }                } else {                    UtilityController::message('Bạn chưa chọn nhà tuyển dụng');                }            }            if (isset($_POST["khonghoatdong"])) {                $array = $_POST["checklist"];                if ($array != null) {                    $update_array = array();                    foreach ($array as $value) {                        $update_array[] = $value;                    }                    if ($Dm_nha_tuyen_dung_model->update_khonghoatdong($update_array)) {                        UtilityController::messageSuccess();                    } else {                        UtilityController::messageError();                    }                } else {                    UtilityController::message('Bạn chưa chọn nhà tuyển dụng');                }            }            // delete            if ($_IsDelete) {                if (isset($_POST["btnDelete"])) {                    if (isset($_POST["checklist"])) {                        $array = $_POST["checklist"];                        if ($array != null) {                            $array_delete = array();                            foreach ($array as $value) {                                $array_delete[] = $value;                            }                            if ($Dm_nha_tuyen_dung_model->delete_array($array_delete)) {                                UtilityController::messageSuccess();                            } else {                                UtilityController::messageError();                            }                        }                    } else {                        UtilityController::message('Bạn chưa chọn nhà tuyển dụng');                    }                }            }            if (!empty($_Name)) {                $Dm_nha_tuyen_dung_model->setName($_Name);            }            if (!empty($_TinhThanhs)) {                $_TinhThanhss = implode(',', $_TinhThanhs);                $Dm_nha_tuyen_dung_model->setTinhThanhs($_TinhThanhss);            }            if (!empty($_NganhNghes)) {                $_NganhNghess = implode(',', $_NganhNghes);                $Dm_nha_tuyen_dung_model->setNganhNghes($_NganhNghess);            }            if ($_NoiBat != 5) {                $Dm_nha_tuyen_dung_model->setIsNoiBat($_NoiBat);            }            if ($_XacThuc != 5) {                $Dm_nha_tuyen_dung_model->setIsXacThuc($_XacThuc);            }            if ($_Active != 5) {                $Dm_nha_tuyen_dung_model->setIsActive($_Active);            }            $Dm_nha_tuyen_dung_model->setRowStart($start);            $Dm_nha_tuyen_dung_model->setNumLinePerPage($num_rows_per_page);            $list = $Dm_nha_tuyen_dung_model->getList();            $rowrount = $Dm_nha_tuyen_dung_model->getCount();            $phantrang = UtilityController::phantrang($rowrount, $num_rows_per_page, $page);            require_once ADMIN_VIEW_DIRECTORY . DS . Nha_tuyen_dungController::FOLDER_VIEW . DS . "list.php";        }    }    public function update() {        $Dm_nganh_ngheModel = new Dm_nganh_ngheModel();        $List_nganh_nghe = $Dm_nganh_ngheModel->getList();        $Dm_tinh_thanhModel = new Dm_tinh_thanhModel();        $List_tinh_thanh = $Dm_tinh_thanhModel->getList();        $Dm_Quy_Mo = new Dm_quy_mo_doanh_nghiepModel;        $List_Quy_Mo = $Dm_Quy_Mo->getList();        if (isset($_SESSION["user_info_admin"])) {            $tabid = '';            if (isset($_GET["tabid"])) {                $tabid = $_GET["tabid"];            }            $obj_check_role = UtilityController::checkRole();            $_IsView = $obj_check_role["view"];            $_IsUpdate = $obj_check_role["update"];            if (!$_IsView) {                UtilityController::gotoPage("index.php");            }            $Dm_nha_tuyen_dung_model = new Nha_tuyen_dungModel();            $User = new Sys_usersModel();            $_Id = '';            $_HoTen = '';            $_UserId = '';            $_Name = '';            $_DienThoai = '';            $_MST = '';            $_Fax = '';            $_DiaChi = '';            $_Website = '';            $_QuyMoName = '';            $_QuyMoId = '';            $_NguoiLienHe_HoTen = '';            $_NguoiLienHe_DienThoai = '';            $_NguoiLienHe_Email = '';            $_NguoiLienHe_ChucVu = '';            $_XacThuc = false;            $_NoiBat = false;            $_Active = false;            //$_Description = "";            //$_Order = $Dm_nha_tuyen_dung_model->getMaxOrder();            if (isset($_GET["id"])) {                $_Id = $_GET["id"];                $Dm_nha_tuyen_dung_model->setId($_Id);                $obj = $Dm_nha_tuyen_dung_model->getObj();                if (!is_null($obj)) {                    $_Id = $obj->Id;                    $_HoTen = $obj->Username;                    $_UserId = $obj->UserId;                    $_Name = $obj->Name;                    $_DienThoai = $obj->DienThoai;                    $_MST = $obj->MST;                    $_Fax = $obj->Fax;                    $_DiaChi = $obj->DiaChi;                    $_Website = $obj->Website;                    $_QuyMoName = $obj->QuyMoName;                    $_QuyMoId = $obj->QuyMoId;                    $_NguoiLienHe_HoTen = $obj->NguoiLienHe_HoTen;                    $_NguoiLienHe_DienThoai = $obj->NguoiLienHe_DienThoai;                    $_NguoiLienHe_Email = $obj->NguoiLienHe_Email;                    $_NguoiLienHe_ChucVu = $obj->NguoiLienHe_ChucVu;                    $_XacThuc = $obj->IsXacThuc;                    $_NoiBat = $obj->IsNoiBat;                    $_Active = $obj->IsActive;                }            }            require_once ADMIN_VIEW_DIRECTORY . DS . Nha_tuyen_dungController::FOLDER_VIEW . DS . "update.php";        }    }    public function fill_ds_nganh_nghe_nha_tuyen_dung() {        if (isset($_POST)) {            $Id = isset($_POST["Id"]) ? $_POST["Id"] : "";            $Nha_tuyen_dung_nganh_ngheModel = new Nha_tuyen_dung_nganh_ngheModel();            $Nha_tuyen_dung_nganh_ngheModel->setNhaTuyenDungId($Id);            $List = $Nha_tuyen_dung_nganh_ngheModel->getList();            $str = "";            if (!is_null($List)) {                foreach ($List as $value) {                    $str .= $value["NganhNgheId"] . ",";                }            }            $str = rtrim($str, ",");            echo $str;        }    }      public function fill_ds_tinh_thanh_nha_tuyen_dung() {        if (isset($_POST)) {            $Id = isset($_POST["Id"]) ? $_POST["Id"] : "";            $Nha_tuyen_dung_tinh_thanhModel = new Nha_tuyen_dung_tinh_thanhModel();            $Nha_tuyen_dung_tinh_thanhModel->setNhaTuyenDungId($Id);            $List = $Nha_tuyen_dung_tinh_thanhModel->getList();            if (!is_null($List)) {                $str = "";                foreach ($List as $value) {                    $str .= $value["TinhThanhId"] . ",";                }            }            $str = rtrim($str, ",");            echo $str;        }    }    public function doUpdate() {        if (isset($_SESSION["user_info_admin"])) {            $tabid = '';            if (isset($_GET["tabid"])) {                $tabid = $_GET["tabid"];            }            $obj_check_role = UtilityController::checkRole();            $_IsUpdate = $obj_check_role["update"];            if (!$_IsUpdate) {                UtilityController::gotoPage("index.php");            }            //hang nay de lay gia tri             $username = $_SESSION["user_info_admin"]["username"];            $_Name = isset($_POST["tencongty"]) ? $_POST["tencongty"] : "";            $_HoTen = isset($_POST["email"]) ? $_POST["email"] : "";            $_UserId=isset($_POST["UserId"]) ? $_POST["UserId"] : "";            $_MST = isset($_POST["masothue"]) ? $_POST["masothue"] : "";            $_DienThoai = isset($_POST["dienthoai"]) ? $_POST["dienthoai"] : "";            $_Fax = isset($_POST["fax"]) ? $_POST["fax"] : "";            $_DiaChi = isset($_POST["diachi"]) ? $_POST["diachi"] : "";            $_Website = isset($_POST["web"]) ? $_POST["web"] : "";            $_QuyMoId = isset($_POST["dm_Quy_Mo"]) ? $_POST["dm_Quy_Mo"] : "";            $_NoiBatId = isset($_POST["NoiBat"]) ? $_POST["NoiBat"] : "";            $_XacThucId = isset($_POST["XacThuc"]) ? $_POST["XacThuc"] : "";            $_ActiveId = isset($_POST["Active"]) ? $_POST["Active"] : "";            $_NhatTuyenDungTinhThanhId = isset($_POST["dm_tinh_thanh"]) ? $_POST["dm_tinh_thanh"] : "";            $_NhatTuyenDungNganhNgheId = isset($_POST["dm_nganh_nghe"]) ? $_POST["dm_nganh_nghe"] : "";            $_NguoiLienHe_HoTen = isset($_POST["hotennguoilienhe"]) ? $_POST["hotennguoilienhe"] : "";            $_NguoiLienHe_ChucVu = isset($_POST["chucvunguoilienhe"]) ? $_POST["chucvunguoilienhe"] : "";            $_NguoiLienHe_DienThoai = isset($_POST["dienthoainguoilienhe"]) ? $_POST["dienthoainguoilienhe"] : "";            $_NguoiLienHe_Email = isset($_POST["nguoilienheemail"]) ? $_POST["nguoilienheemail"] : "";            ///////////            $_Description = isset($_POST["Description"]) ? $_POST["Description"] : "";            $_Order = isset($_POST["Order"]) ? $_POST["Order"] : "";            //hang nay de truyen du lieu vao            $Dm_nha_tuyen_dung_model = new Nha_tuyen_dungModel();            $Dm_nha_tuyen_dung_model->setName($_Name);            if (!isset($_GET{'id'})) {                           };            $Dm_nha_tuyen_dung_model->set_Username($_HoTen);            $Dm_nha_tuyen_dung_model->setMST($_MST);            $Dm_nha_tuyen_dung_model->setDienThoai($_DienThoai);            $Dm_nha_tuyen_dung_model->setFax($_Fax);            $Dm_nha_tuyen_dung_model->setDiaChi($_DiaChi);            $Dm_nha_tuyen_dung_model->setUserId($_UserId);            $Dm_nha_tuyen_dung_model->setWebsite($_Website);            $Dm_nha_tuyen_dung_model->setQuyMoId($_QuyMoId);            $Dm_nha_tuyen_dung_model->setIsNoiBat($_NoiBatId);            $Dm_nha_tuyen_dung_model->setIsXacThuc($_XacThucId);            $Dm_nha_tuyen_dung_model->setIsActive($_ActiveId);            $Dm_nha_tuyen_dung_model->setNguoiLienHe_HoTen($_NguoiLienHe_HoTen);            $Dm_nha_tuyen_dung_model->setNguoiLienHe_ChucVu($_NguoiLienHe_ChucVu);            $Dm_nha_tuyen_dung_model->setNguoiLienHe_DienThoai($_NguoiLienHe_DienThoai);            $Dm_nha_tuyen_dung_model->setNguoiLienHe_Email($_NguoiLienHe_Email);            $Dm_nha_tuyen_dung_model->setTinhThanhs($_NhatTuyenDungTinhThanhId);            $Dm_nha_tuyen_dung_model->setNganhNghes($_NhatTuyenDungNganhNgheId);            /////////////////            $Dm_nha_tuyen_dung_model->setAlias(UtilityController::convert2Alias($_Name));            if (!empty($_Order)) {                $Dm_nha_tuyen_dung_model->setOrder($_Order);            }            $Dm_nha_tuyen_dung_model->setUpdatedBy($username);            $_Id = "";            if (isset($_GET["id"])) {                $_Id = $_GET["id"];            }            if (!empty($_Id)) {                $Dm_nha_tuyen_dung_model->setId($_Id);                if ($Dm_nha_tuyen_dung_model->update()) {                    UtilityController::message("Đã cập nhật thành công");                } else {                    UtilityController::messageError();                }                UtilityController::gotoPage("index.php?ctl=Nha_tuyen_dung&act=update&id=" . $_Id . "&tabid=" . $tabid);            } else {                $Dm_nha_tuyen_dung_model->setCreatedBy($username);                if ($Dm_nha_tuyen_dung_model->insert()) {                                      UtilityController::message("Đã thêm mới thành công");                } else {                    UtilityController::messageError();                }                UtilityController::gotoPage("index.php?ctl=Nha_tuyen_dung&act=update&tabid=" . $tabid);            }        }    }    public function kiem_tra_email() {        if (isset($_POST)) {            $email = isset($_POST["email"]) ? $_POST["email"] : "";            $oldemail = isset($_POST["oldemail"]) ? $_POST["oldemail"] : "";            $Sys_usersModel = new Sys_usersModel();            $Sys_usersModel->set_Username($email);            $Sys_usersModel->setOldEmail($oldemail);            $count = $Sys_usersModel->getCount();            if ($count > 0) {                echo "false";            } else {                echo "true";            }        }    }        public function DoiMk() {        if (isset($_SESSION["user_info_admin"])) {            $tabid = '';            if (isset($_GET["tabid"])) {                $tabid = $_GET["tabid"];            }            $obj_check_role = UtilityController::checkRole();            $_IsView = $obj_check_role["view"];            $_IsUpdate = $obj_check_role["update"];            if (!$_IsView) {                UtilityController::gotoPage("index.php");            }            $Nha_tuyen_dung_model = new Nha_tuyen_dungModel();            $_MatKhau = isset($_POST['txtMatKhau']) ? $_POST['txtMatKhau'] : "";            $_Email = "";            $_UserId = "";            if (isset($_GET["id"])) {                $_Id = $_GET["id"];                $Nha_tuyen_dung_model->setId($_Id);                $obj = $Nha_tuyen_dung_model->getObj();                if (!is_null($obj)) {                    $_Email = $obj->Username;                    $_UserId = $obj->UserId;                }            }            $Nha_tuyen_dung_model->setUserPassword($_MatKhau);            $Nha_tuyen_dung_model->setUserId($_UserId);            if (isset($_POST['btnSave'])) {                if (!empty($_Id)) {                    $Nha_tuyen_dung_model->setId($_Id);                    if ($Nha_tuyen_dung_model->DoiMk()) {                        UtilityController::message("Đã cập nhật thành công");                    } else {                        UtilityController::messageError();                    }                    UtilityController::gotoPage("index.php?ctl=Nha_tuyen_dung&act=DoiMk&id=" . $_Id . "&tabid=" . $tabid);                }            }            require_once ADMIN_VIEW_DIRECTORY . DS . Nha_tuyen_dungController::FOLDER_VIEW . DS . "PassWord.php";        }    }    public function xuat_excel() {        if (isset($_POST)) {            $Dm_nha_tuyen_dung_model = new Nha_tuyen_dungModel();            if (!empty($_POST['Ids'])) {                $Dm_nha_tuyen_dung_model->setIds($_POST['Ids']);            }            $_List = $Dm_nha_tuyen_dung_model->getList();            require (PHP_EXCEL_ADMIN_DIRECTORY);            $objPHPExcel = new PHPExcel;// Set properties            $objPHPExcel->getDefaultStyle()->getFont()->setName("Time New Roman");            $objPHPExcel->getDefaultStyle()->getFont()->setSize(10);// Add some data            $objPHPExcel->setActiveSheetIndex(0);            $Dm_nha_tuyen_dung_model->setRoleId($_SESSION["user_info_admin"]["role"]);            $i = "1";            $ii = "0";            $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow(0, 1, '#');            $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow(1, 1, 'Tiêu Đề');            foreach ($_List as $value) {                $i = $i + 1;                $ii = $ii + 1;                $column = 0;                $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $ii);                $column = $column + 1;                $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['Id']);                $column = $column + 1;                $Dm_nha_tuyen_dung_model->setId($value['Id']);                $str = "";                $str1 = "";                if ($_POST['nameexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Tên nhà tuyển dụng');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['Name']);                    $column = $column + 1;                }                if ($_POST['tinhthanhexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Tỉnh Thành');                    foreach ($Dm_nha_tuyen_dung_model->getTinhThanh() as $val) {                        $str .= $val["Name"] . ",";                    }                    $str = rtrim($str, ",");                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $str);                    $column = $column + 1;                }                if ($_POST['nguoilienheemailexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Email người liên hệ');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['NguoiLienHe_Email']);                    $column = $column + 1;                }                if ($_POST['sodienthoainguoilienheexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Số điện thoại người liên hệ');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['NguoiLienHe_DienThoai']);                    $column = $column + 1;                }                if ($_POST['chucvunguoilienheexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Chức vụ người liên hệ');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['NguoiLienHe_ChucVu']);                    $column = $column + 1;                }                if ($_POST['tennguoilienheexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Tên người liên hệ');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['NguoiLienHe_HoTen']);                    $column = $column + 1;                }                if ($_POST['websiteexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Website');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['Website']);                    $column = $column + 1;                }                if ($_POST['quimoexcel'] == 'true') {                    $quimo = new Dm_quy_mo_doanh_nghiepModel();                    $quimo->setId($value['QuyMoId']);                    $listquimo = $quimo->getList();                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Qui mô');                    foreach ($listquimo as $v) {                        $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $v['Name']);                    }$column = $column + 1;                }                if ($_POST['masothueexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Mã số thuế');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['MST']);                    $column = $column + 1;                }                if ($_POST['diachiexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Địa chỉ');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['DiaChi']);                    $column = $column + 1;                }                if ($_POST['faxexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'FAX');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['Fax']);                    $column = $column + 1;                }                if ($_POST['sodienthoaiexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Điện thoại');                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $value['DienThoai']);                    $column = $column + 1;                }                if ($_POST['nganhngheexcel'] == 'true') {                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, 1, 'Ngành Nghề');                    foreach ($Dm_nha_tuyen_dung_model->getNganhNghe() as $val) {                        $str1 .= $val["Name"] . ",";                    }                    $str1 = rtrim($str1, ",");                    $objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($column, $i, $str1);                    $column = $column + 1;                }            }// Rename sheet            $objPHPExcel->getActiveSheet()->setTitle('Simple');            PHPExcel_Shared_Font::setAutoSizeMethod(PHPExcel_Shared_Font::AUTOSIZE_METHOD_EXACT);            foreach (range('A', 'Z') as $columnID) {                $objPHPExcel->getActiveSheet()->getColumnDimension($columnID)                        ->setAutoSize(true);            }// Save Excel 2007 file            $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, "Excel2007");            $filename = UtilityController::gen_uuid();            $url_dl = ROOT_ADMIN_URL . "/_temp/" . $filename . ".xls";            $url1 = str_replace(".php", ".xls", __FILE__);            $url2 = str_replace(__CLASS__, $filename, $url1);            $url = str_replace("controllers", "_temp", $url2);            $objWriter->save($url);//                if (!empty($url)) {//                     UtilityController::gotoPage($url_dl);//                    //UtilityController::messageSuccess();//                    //                } else {//                    UtilityController::messageError();//                }            echo $url_dl;        }    }}